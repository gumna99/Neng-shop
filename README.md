# Neng Shop é›»å•†æœƒå“¡ç³»çµ±

ä¸€å€‹åŸºæ–¼ Node.js + TypeScript + PostgreSQL çš„ç¾ä»£åŒ–é›»å•†æœƒå“¡ç³»çµ±ï¼Œæ”¯æ´åŸç”Ÿ SQL å’Œ TypeORM é›™è»Œé–‹ç™¼æ¶æ§‹ã€‚

## ğŸ¯ å°ˆæ¡ˆæ¦‚è¿°

Neng Shop æ˜¯ä¸€å€‹å®Œæ•´çš„é›»å•†æœƒå“¡ç³»çµ±ï¼Œå…·å‚™ä½¿ç”¨è€…ç®¡ç†ã€å•†å“ç®¡ç†ã€è¨‚å–®è™•ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚å°ˆæ¡ˆæ¡ç”¨é›™è»ŒæŠ€è¡“æ¶æ§‹ï¼ŒåŒæ™‚æ”¯æ´åŸç”Ÿ SQL å’Œ TypeORMï¼Œé©åˆå­¸ç¿’å’Œç†è§£ä¸åŒè³‡æ–™å­˜å–æ–¹å¼çš„å„ªç¼ºé»ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- **ä½¿ç”¨è€…ç³»çµ±**ï¼šè¨»å†Šã€ç™»å…¥ã€æ¬Šé™ç®¡ç†ï¼ˆè²·å®¶ã€è³£å®¶ã€ç®¡ç†å“¡ï¼‰ âœ…
- **å•†å“ç³»çµ±**ï¼šå•†å“ CRUDã€åº«å­˜ç®¡ç†ã€æœå°‹ç¯©é¸åŠŸèƒ½ âœ… 
- **åˆ†é¡ç³»çµ±**ï¼š6å¤§å•†å“åˆ†é¡ã€çµ±è¨ˆåˆ†æã€å®Œæ•´æœå°‹æ”¯æ´ âœ…
- **èªè­‰ç³»çµ±**ï¼šJWT é›™æ¬Šæ–ã€å¯†ç¢¼åŠ å¯†ã€æ¬Šé™æ§åˆ¶ âœ…
- **æ¬Šé™æ§åˆ¶**ï¼šåŸºæ–¼è§’è‰²çš„å­˜å–æ§åˆ¶ï¼ˆRBACï¼‰âœ…
- **è³¼ç‰©è»Šç³»çµ±**ï¼šè³¼ç‰©è»Š CRUDã€åº«å­˜æª¢æŸ¥ã€åƒ¹æ ¼å¿«ç…§ã€æ™ºèƒ½æé†’ âœ…
- **è¨‚å–®ç³»çµ±**ï¼šè¨‚å–®å»ºç«‹ã€ç‹€æ…‹ç®¡ç†ã€çµå¸³æµç¨‹ã€åº«å­˜æ‰£æ¸› âœ…

## ğŸ› ï¸ æŠ€è¡“æ¶æ§‹

### å¾Œç«¯æŠ€è¡“æ£§

- **æ¡†æ¶**: Express.js + TypeScript
- **è³‡æ–™åº«**: PostgreSQL (Docker å®¹å™¨åŒ–)
- **ORM**: TypeORM + åŸç”Ÿ SQL (é›™è»Œä¸¦è¡Œ)
- **èªè­‰**: JWT + bcrypt
- **é©—è­‰**: Joi + class-validator
- **é–‹ç™¼å·¥å…·**: nodemonã€ts-nodeã€Docker Compose

### å°ˆæ¡ˆçµæ§‹

```
src/
â”œâ”€â”€ app.ts           # Express æ‡‰ç”¨ç¨‹å¼ä¸»æª”æ¡ˆ
â”œâ”€â”€ index.ts         # æ‡‰ç”¨ç¨‹å¼å…¥å£é»
â”œâ”€â”€ config/          # è¨­å®šæª”æ¡ˆ
â”‚   â”œâ”€â”€ database.ts  # åŸç”Ÿ PostgreSQL é€£ç·šé…ç½®
â”‚   â”œâ”€â”€ typeorm.ts   # TypeORM DataSource é…ç½®
â”‚   â””â”€â”€ env.ts       # ç’°å¢ƒè®Šæ•¸ç®¡ç†
â”œâ”€â”€ entities/        # TypeORM å¯¦é«”å®šç¾©
â”‚   â”œâ”€â”€ User.entity.ts
â”‚   â”œâ”€â”€ Product.entity.ts
â”‚   â”œâ”€â”€ Cart.entity.ts
â”‚   â”œâ”€â”€ CartItem.entity.ts
â”‚   â”œâ”€â”€ Order.entity.ts
â”‚   â””â”€â”€ OrderItem.entity.ts
â”œâ”€â”€ models/          # è³‡æ–™æ¨¡å‹å®šç¾©
â”œâ”€â”€ repositories/    # è³‡æ–™å­˜å–å±¤
â”‚   â””â”€â”€ BaseRepository.ts
â”œâ”€â”€ services/        # æ¥­å‹™é‚è¼¯å±¤
â”‚   â”œâ”€â”€ UserService.ts
â”‚   â”œâ”€â”€ ProductService.ts
â”‚   â”œâ”€â”€ CartService.ts
â”‚   â””â”€â”€ OrderService.ts
â”œâ”€â”€ controllers/     # HTTP è«‹æ±‚è™•ç†å±¤
â”‚   â”œâ”€â”€ AuthController.ts
â”‚   â”œâ”€â”€ ProductController.ts
â”‚   â”œâ”€â”€ CartController.ts
â”‚   â””â”€â”€ OrderController.ts
â”œâ”€â”€ routes/          # API è·¯ç”±å®šç¾©
â”‚   â”œâ”€â”€ auth.ts      # èªè­‰ç›¸é—œè·¯ç”±
â”‚   â”œâ”€â”€ products.ts  # å•†å“ç›¸é—œè·¯ç”±
â”‚   â”œâ”€â”€ cart.ts      # è³¼ç‰©è»Šç›¸é—œè·¯ç”±
â”‚   â”œâ”€â”€ orders.ts    # è¨‚å–®ç›¸é—œè·¯ç”±
â”‚   â””â”€â”€ index.ts     # è·¯ç”±å…¥å£æª”æ¡ˆ
â”œâ”€â”€ middleware/      # ä¸­ä»‹è»Ÿé«”
â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ password.ts  # å¯†ç¢¼åŠ å¯†å·¥å…·
â”‚   â”œâ”€â”€ jwt.ts       # JWT æ¬Šæ–å·¥å…·
â”‚   â””â”€â”€ apiResponse.ts # API å›æ‡‰æ ¼å¼åŒ–å·¥å…·
â”œâ”€â”€ types/           # TypeScript å‹åˆ¥å®šç¾©
â”‚   â”œâ”€â”€ api.types.ts # API å›æ‡‰æ ¼å¼
â”‚   â”œâ”€â”€ user.types.ts # ä½¿ç”¨è€…ç›¸é—œå‹åˆ¥
â”‚   â”œâ”€â”€ product.types.ts # å•†å“ç›¸é—œå‹åˆ¥
â”‚   â”œâ”€â”€ cart.types.ts # è³¼ç‰©è»Šç›¸é—œå‹åˆ¥
â”‚   â””â”€â”€ order.types.ts # è¨‚å–®ç›¸é—œå‹åˆ¥
â””â”€â”€ scripts/         # é–‹ç™¼è¼”åŠ©è…³æœ¬
    â””â”€â”€ testBothConnections.ts
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¦æ±‚

- Node.js 18+
- Docker & Docker Compose
- PostgreSQL 15+

### å®‰è£æ­¥é©Ÿ

1. **å…‹éš†å°ˆæ¡ˆ**
```bash
git clone <repository-url>
cd Neng-shop
```

2. **å®‰è£ä¾è³´**
```bash
npm install
```

3. **ç’°å¢ƒé…ç½®**
```bash
# åœ¨ src/config/ ç›®éŒ„ä¸‹å‰µå»º .env æª”æ¡ˆ
DB_HOST=localhost
DB_PORT=5432
DB_NAME=neng_shop
DB_USER=myusername
DB_PASSWORD=mypassword
JWT_SECRET=your-jwt-secret-key
JWT_ACCESS_SECRET=your-access-secret
JWT_REFRESH_SECRET=your-refresh-secret
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d
PORT=3000
BCRYPT_ROUNDS=12
```

4. **å•Ÿå‹•è³‡æ–™åº«**
```bash
docker-compose up -d
```

5. **æ¸¬è©¦é€£ç·š**
```bash
# æ¸¬è©¦åŸç”Ÿ SQL å’Œ TypeORM é€£ç·š
npm run dev:db
```

6. **å•Ÿå‹•é–‹ç™¼æœå‹™å™¨**
```bash
npm run dev
```

## ğŸ“ å¯ç”¨æŒ‡ä»¤

```bash
# é–‹ç™¼æ¨¡å¼
npm run dev              # å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
npm run dev:db           # æ¸¬è©¦è³‡æ–™åº«é€£ç·š
npm run dev:db:typeorm   # æ¸¬è©¦ TypeORM é€£ç·š

# å»ºæ§‹
npm run build            # ç·¨è­¯ TypeScript
npm start               # å•Ÿå‹•ç”Ÿç”¢ç’°å¢ƒæœå‹™å™¨

# æ¸¬è©¦ (å°šæœªå¯¦ä½œ)
# npm test               # åŸ·è¡Œæ¸¬è©¦ (å¾…å¯¦ä½œ)
```

## ğŸ”§ é–‹ç™¼ç‰¹è‰²

### é›™è»ŒæŠ€è¡“æ¶æ§‹

æœ¬å°ˆæ¡ˆæ¡ç”¨**é›™è»Œä¸¦è¡Œ**çš„é–‹ç™¼æ–¹å¼ï¼š

1. **åŸç”Ÿ SQL å±¤** (`src/config/database.ts`)
   - ä½¿ç”¨ `pg` å¥—ä»¶ç›´æ¥é€£ç·š PostgreSQL
   - é©åˆå­¸ç¿’ SQL èªå¥å’Œè³‡æ–™åº«æ“ä½œ
   - æä¾›å®Œæ•´çš„æ§åˆ¶æ¬Šå’Œæ•ˆèƒ½å„ªåŒ–

2. **TypeORM å±¤** (`src/config/typeorm.ts`)
   - ä½¿ç”¨ TypeORM æä¾›çš„ Entity å’Œ Repository
   - æ”¯æ´è£é£¾å™¨èªæ³•å’Œé—œè¯é—œä¿‚
   - æä¾› Migration å’Œ Schema åŒæ­¥åŠŸèƒ½

### å®‰å…¨æ€§è¨­è¨ˆ

- **å¯†ç¢¼å®‰å…¨**: ä½¿ç”¨ bcrypt é€²è¡Œå¯†ç¢¼é›œæ¹Š (12 rounds)
- **JWT èªè­‰**: é›™æ¬Šæ–ç³»çµ± (Access + Refresh Token)
- **è³‡æ–™é©—è­‰**: Joi å’Œ class-validator é›™é‡é©—è­‰
- **ç’°å¢ƒè®Šæ•¸**: æ•æ„Ÿè³‡è¨Šå…¨éƒ¨ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ç®¡ç†

### å‹åˆ¥å®‰å…¨

- **å®Œæ•´çš„ TypeScript æ”¯æ´**: åš´æ ¼æ¨¡å¼å•Ÿç”¨
- **è‡ªå®šç¾©å‹åˆ¥**: ç‚º APIã€ä½¿ç”¨è€…ã€è³‡æ–™åº«æ“ä½œå®šç¾©æ˜ç¢ºå‹åˆ¥
- **è£é£¾å™¨æ”¯æ´**: å•Ÿç”¨ `experimentalDecorators` å’Œ `emitDecoratorMetadata`

## ğŸ—ƒï¸ è³‡æ–™åº«ç®¡ç†

```bash
# å•Ÿå‹• PostgreSQL å’Œ pgAdmin
docker-compose up -d

# è³‡æ–™åº«é€£ç·šæ¸¬è©¦
npm run dev:db

# æŸ¥çœ‹è³‡æ–™åº«ç®¡ç†ä»‹é¢
# pgAdmin: http://localhost:8080
# Email: admin@example.com
# Password: admin123
```

## ğŸ”’ èªè­‰èˆ‡æˆæ¬Š

### JWT æ¬Šæ–ç³»çµ±

```typescript
// ç”Ÿæˆæ¬Šæ–å°
const tokens = JwtUtil.generateTokenPair(user);

// é©—è­‰ Access Token
const payload = JwtUtil.verifyAccessToken(token);

// é©—è­‰ Refresh Token
const refreshPayload = JwtUtil.verifyRefreshToken(refreshToken);
```

### å¯†ç¢¼ç®¡ç†

```typescript
// å¯†ç¢¼åŠ å¯†
const hashedPassword = await PasswordUtils.hash(password);

// å¯†ç¢¼é©—è­‰
const isValid = await PasswordUtils.compare(password, hashedPassword);

// å¯†ç¢¼å¼·åº¦æª¢æŸ¥
const validation = PasswordUtils.validateStrength(password);
```

## ğŸ“¡ API ç«¯é»æ–‡æª”

### èªè­‰ç›¸é—œ API âœ… **å·²å¯¦ä½œ**

#### ä¸»è¦ç«¯é»
- `POST /api/auth/register` - ç”¨æˆ¶è¨»å†Š
- `POST /api/auth/login` - ç”¨æˆ¶ç™»å…¥  
- `POST /api/v1/auth/refresh` - æ¬Šæ–æ›´æ–°
- `GET /api/v1/auth/profile` - å–å¾—å€‹äººè³‡æ–™
- `PUT /api/v1/auth/profile` - æ›´æ–°å€‹äººè³‡æ–™
- `PUT /api/v1/auth/password` - ä¿®æ”¹å¯†ç¢¼
- `POST /api/v1/auth/logout` - ç™»å‡º

#### ğŸ”„ é–‹ç™¼ä¸­ç«¯é»
- `GET /api/v1/auth/google` - Google OAuth ç™»å…¥

### å•†å“ç®¡ç† API âœ… **å·²å¯¦ä½œ**

#### å…¬é–‹API (ç„¡éœ€èªè­‰)
- `GET /api/v1/products` - å•†å“åˆ—è¡¨ (æ”¯æ´æœå°‹ã€ç¯©é¸ã€åˆ†é ã€æ’åº)
- `GET /api/v1/products/:id` - å•†å“è©³æƒ…
- `GET /api/v1/products/categories` - åˆ†é¡çµ±è¨ˆ

#### è³£å®¶API (éœ€è¦èªè­‰ + è³£å®¶æ¬Šé™)
- `POST /api/v1/products` - å»ºç«‹å•†å“
- `PUT /api/v1/products/:id` - æ›´æ–°å•†å“
- `DELETE /api/v1/products/:id` - åˆªé™¤å•†å“ (è»Ÿåˆªé™¤)

#### æ”¯æ´åŠŸèƒ½
- **æœå°‹ç¯©é¸**: é—œéµå­—ã€åƒ¹æ ¼å€é–“ã€åˆ†é¡ç¯©é¸
- **æ’åº**: åƒ¹æ ¼ã€æ™‚é–“ã€åç¨± (å‡åº/é™åº)
- **åˆ†é **: å®Œæ•´åˆ†é æ©Ÿåˆ¶
- **æ¬Šé™æ§åˆ¶**: è³£å®¶åªèƒ½ç®¡ç†è‡ªå·±çš„å•†å“
- **å•†å“åˆ†é¡**: 6å¤§åˆ†é¡ (æ™‚å°šã€é›»å­ã€å±…å®¶ã€ç¾å¦ã€é‹å‹•ã€å…¶ä»–)

### è³¼ç‰©è»Šç®¡ç† API âœ… **å·²å¯¦ä½œ**

#### ä¸»è¦ç«¯é» (éœ€è¦èªè­‰)
- `GET /api/v1/cart` - å–å¾—ä½¿ç”¨è€…è³¼ç‰©è»Š
- `POST /api/v1/cart/items` - åŠ å…¥å•†å“åˆ°è³¼ç‰©è»Š
- `PUT /api/v1/cart/items/:cartItemId` - æ›´æ–°è³¼ç‰©è»Šå•†å“æ•¸é‡
- `DELETE /api/v1/cart/items/:cartItemId` - ç§»é™¤è³¼ç‰©è»Šä¸­çš„å•†å“
- `DELETE /api/v1/cart` - æ¸…ç©ºè³¼ç‰©è»Š

#### æ ¸å¿ƒåŠŸèƒ½
- åº«å­˜é©—è­‰èˆ‡è‡ªå‹•èª¿æ•´ã€åƒ¹æ ¼å¿«ç…§ã€æ™ºèƒ½è­¦å‘Šç³»çµ±ã€è‡ªå‹•è¨ˆç®—ç¸½é¡

### è¨‚å–®ç®¡ç† API âœ… **å·²å¯¦ä½œ**

#### ä¸»è¦ç«¯é» (éœ€è¦èªè­‰)
- `POST /api/v1/orders` - å»ºç«‹è¨‚å–® (å¾è³¼ç‰©è»Š)
- `GET /api/v1/orders` - å–å¾—ä½¿ç”¨è€…è¨‚å–®åˆ—è¡¨
- `GET /api/v1/orders/:id` - å–å¾—è¨‚å–®è©³æƒ…
- `PATCH /api/v1/orders/:id/cancel` - å–æ¶ˆè¨‚å–®

#### æ ¸å¿ƒåŠŸèƒ½
- è³¼ç‰©è»Šè½‰è¨‚å–®æµç¨‹ã€å•†å“å¿«ç…§ä¿å­˜ã€Transaction åŸå­æ€§ã€æ‚²è§€é–ä½µç™¼æ§åˆ¶ã€åº«å­˜å›è£œæ©Ÿåˆ¶

## ğŸ¨ API è¨­è¨ˆ

### çµ±ä¸€å›æ‡‰æ ¼å¼
æ‰€æœ‰ API å›æ‡‰éƒ½éµå¾ªæ¨™æº–æ ¼å¼ï¼š`{ success, message, data?, error?, timestamp }`

### éŒ¯èª¤è™•ç†
çµ±ä¸€çš„éŒ¯èª¤ç¢¼ç³»çµ±ï¼ŒåŒ…å«èªè­‰ã€æ¬Šé™ã€è³‡æ–™é©—è­‰ç­‰éŒ¯èª¤é¡å‹

## ğŸ“Š é–‹ç™¼é€²åº¦

### å·²å®ŒæˆåŠŸèƒ½

- âœ… **åŸºç¤è¨­æ–½å»ºç½®**
  - Express + TypeScript å°ˆæ¡ˆæ¶æ§‹
  - Docker PostgreSQL ç’°å¢ƒ
  - é›™è»Œè³‡æ–™åº«é€£ç·šè¨­å®š
  - ç’°å¢ƒè®Šæ•¸ç®¡ç†ç³»çµ±

- âœ… **æ ¸å¿ƒå·¥å…·é–‹ç™¼**
  - JWT æ¬Šæ–ç®¡ç†ç³»çµ± (Access + Refresh Token)
  - å¯†ç¢¼åŠ å¯†å’Œé©—è­‰å·¥å…· (bcrypt + 12 rounds)
  - API å›æ‡‰æ ¼å¼æ¨™æº–åŒ–
  - TypeScript å‹åˆ¥å®šç¾© (ä½¿ç”¨è€…ã€APIã€JWT)

- âœ… **è³‡æ–™æ¨¡å‹è¨­è¨ˆ**
  - User Entity å®Œæ•´å¯¦ä½œ (è»Ÿåˆªé™¤ã€è§’è‰²ç³»çµ±ã€OAuth æ”¯æ´)
  - UserService å®Œæ•´ CRUD åŠŸèƒ½
  - åŸºç¤ Repository æŠ½è±¡é¡åˆ¥
  - è³‡æ–™é©—è­‰è¦å‰‡ (Joi + class-validator)

- âœ… **èªè­‰ç³»çµ± (100% å®Œæˆ)** ğŸ‰
  - ä½¿ç”¨è€…è¨»å†Š API (POST /api/v1/auth/register)
  - ä½¿ç”¨è€…ç™»å…¥ API (POST /api/v1/auth/login)
  - **ğŸ†• æ¬Šæ–æ›´æ–° API (POST /api/v1/auth/refresh)** - æ”¯æ´ Token åˆ·æ–°
  - JWT æ¬Šæ–ç”Ÿæˆå’Œé©—è­‰
  - å¯†ç¢¼å¼·åº¦é©—è­‰å’ŒåŠ å¯†
  - JWT ä¸­ä»‹è»Ÿé«” (æ¬Šæ–é©—è­‰å’Œè§’è‰²æª¢æŸ¥)
  - å—ä¿è­· API ç«¯é» (profile, password, logout)

- âœ… **å•†å“ç®¡ç†ç³»çµ± (100% å®Œæˆ)** ğŸ‰
  - Product Entity è¨­è¨ˆ (å•†å“ã€åˆ†é¡ã€ç‹€æ…‹ã€è»Ÿåˆªé™¤)
  - å•†å“ CRUD API (å»ºç«‹ã€æŸ¥è©¢ã€æ›´æ–°ã€åˆªé™¤)
  - å®Œæ•´æœå°‹ç¯©é¸åŠŸèƒ½ (é—œéµå­—ã€åƒ¹æ ¼å€é–“ã€åˆ†é¡)
  - åˆ†é å’Œæ’åºæ©Ÿåˆ¶ (åƒ¹æ ¼ã€æ™‚é–“ã€åç¨±)
  - 6å€‹å•†å“åˆ†é¡ç³»çµ± (æ™‚å°šã€é›»å­ã€å±…å®¶ã€ç¾å¦ã€é‹å‹•ã€å…¶ä»–)
  - åˆ†é¡çµ±è¨ˆ API (å•†å“æ•¸é‡ã€å¹³å‡åƒ¹æ ¼çµ±è¨ˆ)
  - è³£å®¶æ¬Šé™æ§åˆ¶ (åªèƒ½ç®¡ç†è‡ªå·±çš„å•†å“)
  - åº«å­˜ç®¡ç† (è‡ªå‹•ç‹€æ…‹æ›´æ–°)
  - å•†å“èˆ‡ç”¨æˆ¶é—œè¯ (seller relationship)

- âœ… **è³¼ç‰©è»Šç³»çµ± (100% å®Œæˆ)** ğŸ‰
  - Cart å’Œ CartItem Entity è¨­è¨ˆ (ä¸€å°ä¸€å’Œä¸€å°å¤šé—œè¯)
  - è³¼ç‰©è»Š CRUD API (æŸ¥çœ‹ã€åŠ å…¥ã€æ›´æ–°ã€åˆªé™¤ã€æ¸…ç©º)
  - åº«å­˜è‡ªå‹•é©—è­‰å’Œæ•¸é‡èª¿æ•´æ©Ÿåˆ¶
  - åƒ¹æ ¼å¿«ç…§åŠŸèƒ½ (è¨˜éŒ„åŠ å…¥æ™‚çš„åƒ¹æ ¼)
  - æ™ºèƒ½è­¦å‘Šç³»çµ± (åº«å­˜ä¸è¶³ã€åƒ¹æ ¼è®Šå‹•ã€ä½åº«å­˜æé†’)
  - è‡ªå‹•è¨ˆç®—ç¸½æ•¸é‡å’Œç¸½é‡‘é¡
  - å®Œæ•´çš„å•†å“è³‡è¨Šé—œè¯å±•ç¤º
  - è³¼ç‰©è»Šèˆ‡ç”¨æˆ¶ä¸€å°ä¸€é—œè¯ (è‡ªå‹•å»ºç«‹)

- âœ… **è¨‚å–®ç³»çµ± (100% å®Œæˆ)** ğŸ‰
  - Order å’Œ OrderItem Entity è¨­è¨ˆ (å®Œæ•´è¨‚å–®è³‡æ–™æ¨¡å‹)
  - è¨‚å–® CRUD API (å»ºç«‹ã€æŸ¥è©¢åˆ—è¡¨ã€æŸ¥è©¢è©³æƒ…ã€å–æ¶ˆ)
  - å®Œæ•´çµå¸³æµç¨‹ (è³¼ç‰©è»Šâ†’è¨‚å–®è½‰æ›ã€å•†å“å¿«ç…§ã€åº«å­˜æ‰£æ¸›)
  - Transaction åŸå­æ€§ä¿è­‰ (4æ­¥é©ŸåŸå­æ“ä½œ)
  - æ‚²è§€é–ä½µç™¼æ§åˆ¶ (é˜²æ­¢è¶…è³£å•é¡Œ)
  - è‡ªå®šç¾©æ¥­å‹™éŒ¯èª¤è™•ç† (BusinessErrorã€EmptyCartError ç­‰)
  - åº«å­˜å›è£œæ©Ÿåˆ¶ (å–æ¶ˆè¨‚å–®æ™‚è‡ªå‹•å›å¾©åº«å­˜)
  - è¨‚å–®ç‹€æ…‹ç®¡ç† (pending, cancelled ç­‰ç‹€æ…‹)

### å·²ä¿®å¾©å•é¡Œ

- âœ… **ç³»çµ±ç©©å®šæ€§ä¿®å¾©**
  - ä¿®æ­£ User Entity é è¨­å€¼å•é¡Œ (`isDeleted: false`)
  - ä¿®æ­£ Express è·¯ç”±é †åºå•é¡Œ (API è·¯ç”±åœ¨ 404 è™•ç†å™¨ä¹‹å‰)
  - å®Œæ•´æ¸¬è©¦èªè­‰ç³»çµ±æµç¨‹

### ğŸ†• æœ€æ–°åŠŸèƒ½ (2025-08-12)

- âœ… **Refresh Token ç³»çµ±**
  - å¯¦ä½œå®Œæ•´çš„ Token åˆ·æ–°æ©Ÿåˆ¶
  - æ”¯æ´ Token Rotation å®‰å…¨ç­–ç•¥  
  - å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œç‹€æ…‹ç¢¼å›æ‡‰
  - ç„¡ç¸«çš„ç”¨æˆ¶é«”é©— (15åˆ†é˜ Access Token + 7å¤© Refresh Token)

### å¾…é–‹ç™¼åŠŸèƒ½

- ğŸ“‹ **èªè­‰ç³»çµ±é€²éšåŠŸèƒ½ (å¯é¸)**
  - Google OAuth æ•´åˆ
  - å¯†ç¢¼é‡è¨­åŠŸèƒ½
  - Token é»‘åå–®æ©Ÿåˆ¶

- âœ… **å•†å“ç®¡ç†ç³»çµ± (ç¬¬ 4 é€±) - å·²å®Œæˆ** 
  - âœ… Product Entity è¨­è¨ˆ
  - âœ… å•†å“ CRUD API
  - âœ… åº«å­˜ç®¡ç†æ©Ÿåˆ¶
  - âœ… æœå°‹å’Œç¯©é¸åŠŸèƒ½

- âœ… **è³¼ç‰©è»Šç³»çµ± (ç¬¬ 5 é€±) - å·²å®Œæˆ**
  - âœ… Cart å’Œ CartItem Entity è¨­è¨ˆ
  - âœ… è³¼ç‰©è»Š CRUD API
  - âœ… åº«å­˜æª¢æŸ¥æ©Ÿåˆ¶
  - âœ… åƒ¹æ ¼è®Šå‹•è™•ç†

- âœ… **è¨‚å–®è™•ç†ç³»çµ± (ç¬¬ 6 é€±) - å·²å®Œæˆ**
  - âœ… Order å’Œ OrderItem Entity è¨­è¨ˆ
  - âœ… è¨‚å–®ç‹€æ…‹ç®¡ç† (pending/cancelled)
  - âœ… å®Œæ•´çµå¸³æµç¨‹ (è³¼ç‰©è»Šâ†’è¨‚å–®è½‰æ›)
  - âœ… Transaction åŸå­æ€§ä¿è­‰
  - âœ… æ‚²è§€é–ä½µç™¼æ§åˆ¶
  - âœ… åº«å­˜æ‰£æ¸›èˆ‡å›è£œæ©Ÿåˆ¶

## ğŸ¤ è²¢ç»æŒ‡å—

### é–‹ç™¼è¦ç¯„

1. **ç¨‹å¼ç¢¼é¢¨æ ¼**: éµå¾ª TypeScript åš´æ ¼æ¨¡å¼
2. **æäº¤è¨Šæ¯**: ä½¿ç”¨ `feat:`, `fix:`, `docs:` ç­‰å‰ç¶´
3. **åˆ†æ”¯ç­–ç•¥**: åŠŸèƒ½åˆ†æ”¯ â†’ é–‹ç™¼åˆ†æ”¯ â†’ ä¸»åˆ†æ”¯
4. **æ¸¬è©¦è¦æ±‚**: æ–°åŠŸèƒ½å¿…é ˆåŒ…å«ç›¸æ‡‰æ¸¬è©¦

### æœ¬åœ°é–‹ç™¼

```bash
# ç¢ºä¿è³‡æ–™åº«é‹è¡Œ
docker-compose up -d

# æ¸¬è©¦é€£ç·š
npm run dev:db

# å•Ÿå‹•é–‹ç™¼æ¨¡å¼
npm run dev

# ç·¨è­¯æª¢æŸ¥
npm run build
```

## ğŸ“š å­¸ç¿’è³‡æº

### æ¨è–¦é–±è®€

- [TypeORM å®˜æ–¹æ–‡æª”](https://typeorm.io/)
- [Express.js æœ€ä½³å¯¦å‹™](https://expressjs.com/en/advanced/best-practice-security.html)
- [JWT æœ€ä½³å¯¦å‹™](https://tools.ietf.org/html/rfc7519)
- [PostgreSQL å®˜æ–¹æ–‡æª”](https://www.postgresql.org/docs/)

### æŠ€è¡“å°æ¯”å­¸ç¿’

æœ¬å°ˆæ¡ˆç‰¹åˆ¥é©åˆå­¸ç¿’ï¼š
- åŸç”Ÿ SQL vs ORM çš„å·®ç•°
- ä¸åŒè³‡æ–™å­˜å–æ¨¡å¼çš„å„ªç¼ºé»
- ä¼æ¥­ç´š Node.js æ‡‰ç”¨æ¶æ§‹
- ç¾ä»£ TypeScript é–‹ç™¼å¯¦å‹™

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šæ¢æ¬¾ã€‚

## ğŸ› å•é¡Œå›å ±

å¦‚æœæ‚¨ç™¼ç¾ä»»ä½•å•é¡Œï¼Œè«‹åœ¨ GitHub Issues ä¸­å›å ±ã€‚

---

**å°ˆæ¡ˆç‹€æ…‹**: ç©©å®šé–‹ç™¼ä¸­ | **ç‰ˆæœ¬**: 0.6.0 | **æœ€å¾Œæ›´æ–°**: 2025-10-09

**ç›®å‰é€²åº¦**: ç¬¬ 6 é€± - è¨‚å–®ç³»çµ± (100% å®Œæˆ) ğŸ‰ | **ä¸‹ä¸€é‡Œç¨‹ç¢‘**: è³£å®¶å¾Œå°ç®¡ç†ç³»çµ±

## ğŸ‰ é‡Œç¨‹ç¢‘é”æˆ - å®Œæ•´é›»å•†è³¼ç‰©ç³»çµ±

æ­å–œï¼ä½ å·²ç¶“æˆåŠŸå¯¦ä½œäº†ä¸€å€‹å®Œæ•´çš„é›»å•†è³¼ç‰©ç³»çµ±ï¼ŒåŒ…å«èªè­‰ç³»çµ±ã€å•†å“ç®¡ç†ç³»çµ±ã€è³¼ç‰©è»Šç³»çµ±å’Œè¨‚å–®ç³»çµ±ï¼š

### ğŸ” ä¼æ¥­ç´šèªè­‰ç³»çµ± (ç¬¬3é€±)
- âœ… ç”¨æˆ¶è¨»å†Šèˆ‡ç™»å…¥
- âœ… JWT Access Token (15åˆ†é˜) + Refresh Token (7å¤©) 
- âœ… Token è‡ªå‹•åˆ·æ–°æ©Ÿåˆ¶
- âœ… è§’è‰²æ¬Šé™æ§åˆ¶ (buyer/seller/admin)
- âœ… å—ä¿è­· API ç«¯é»
- âœ… bcrypt å¯†ç¢¼åŠ å¯† (12 rounds)
- âœ… JWT ç°½åé©—è­‰èˆ‡Token Rotation é˜²è­·

### ğŸ›ï¸ å®Œæ•´å•†å“ç®¡ç†ç³»çµ± (ç¬¬4é€±)
- âœ… å•†å“CRUDæ“ä½œ (å»ºç«‹ã€æŸ¥è©¢ã€æ›´æ–°ã€è»Ÿåˆªé™¤)
- âœ… 6å¤§å•†å“åˆ†é¡ç³»çµ± (æ™‚å°šã€é›»å­ã€å±…å®¶ã€ç¾å¦ã€é‹å‹•ã€å…¶ä»–)
- âœ… é—œéµå­—æœå°‹åŠŸèƒ½ (å•†å“åç¨±ã€æè¿°ã€åˆ†é¡ã€è³£å®¶)
- âœ… é€²éšç¯©é¸åŠŸèƒ½ (åƒ¹æ ¼å€é–“ã€åˆ†é¡ç¯©é¸)
- âœ… æ’åºæ©Ÿåˆ¶ (åƒ¹æ ¼ã€æ™‚é–“ã€åç¨±ï¼Œå‡åº/é™åº)
- âœ… å®Œæ•´åˆ†é åŠŸèƒ½ (é æ•¸ã€ç¸½æ•¸ã€å‰å¾Œé åˆ¤æ–·)
- âœ… åˆ†é¡çµ±è¨ˆAPI (å•†å“æ•¸é‡ã€å¹³å‡åƒ¹æ ¼)
- âœ… è³£å®¶æ¬Šé™æ§åˆ¶ (åªèƒ½ç®¡ç†è‡ªå·±çš„å•†å“)
- âœ… åº«å­˜ç®¡ç† (è‡ªå‹•ç‹€æ…‹æ›´æ–°)

### ğŸ›’ å®Œæ•´è³¼ç‰©è»Šç³»çµ± (ç¬¬5é€±)
- âœ… è³¼ç‰©è»Šå¯¦é«”è¨­è¨ˆ (Cart + CartItem é—œè¯è¨­è¨ˆ)
- âœ… è³¼ç‰©è»ŠCRUDæ“ä½œ (æŸ¥çœ‹ã€åŠ å…¥ã€æ›´æ–°ã€ç§»é™¤ã€æ¸…ç©º)
- âœ… æ™ºèƒ½åº«å­˜æª¢æŸ¥ (è‡ªå‹•é©—è­‰åº«å­˜ä¸¦èª¿æ•´æ•¸é‡)
- âœ… åƒ¹æ ¼å¿«ç…§æ©Ÿåˆ¶ (è¨˜éŒ„åŠ å…¥æ™‚çš„å•†å“åƒ¹æ ¼)
- âœ… æ™ºèƒ½è­¦å‘Šç³»çµ± (åº«å­˜ä¸è¶³ã€åƒ¹æ ¼è®Šå‹•ã€ä½åº«å­˜æé†’)
- âœ… è‡ªå‹•è¨ˆç®—åŠŸèƒ½ (ç¸½æ•¸é‡ã€ç¸½é‡‘é¡å³æ™‚è¨ˆç®—)
- âœ… å•†å“è³‡è¨Šå±•ç¤º (å®Œæ•´å•†å“è©³æƒ…ã€åœ–ç‰‡ã€ç‹€æ…‹)
- âœ… ç”¨æˆ¶é—œè¯ç®¡ç† (ä¸€å°ä¸€è³¼ç‰©è»Šè‡ªå‹•å»ºç«‹)

### ğŸ“¦ ä¼æ¥­ç´šè¨‚å–®ç³»çµ± (ç¬¬6é€±)
- âœ… è¨‚å–®å¯¦é«”è¨­è¨ˆ (Order + OrderItem å®Œæ•´é—œè¯è¨­è¨ˆ)
- âœ… è¨‚å–®CRUDæ“ä½œ (å»ºç«‹ã€æŸ¥è©¢åˆ—è¡¨ã€æŸ¥è©¢è©³æƒ…ã€å–æ¶ˆ)
- âœ… ä¼æ¥­ç´šçµå¸³æµç¨‹ (è³¼ç‰©è»Šâ†’è¨‚å–®è½‰æ›ã€å•†å“å¿«ç…§)
- âœ… Transaction åŸå­æ€§ä¿è­‰ (4æ­¥é©ŸåŸå­æ“ä½œç¢ºä¿è³‡æ–™ä¸€è‡´æ€§)
- âœ… æ‚²è§€é–ä½µç™¼æ§åˆ¶ (é˜²æ­¢è¶…è³£å•é¡Œ)
- âœ… æ™ºèƒ½åº«å­˜ç®¡ç† (æ‰£æ¸›èˆ‡å›è£œæ©Ÿåˆ¶)
- âœ… è‡ªå®šç¾©æ¥­å‹™éŒ¯èª¤ (BusinessErrorã€EmptyCartErrorã€InsufficientStockError)
- âœ… è¨‚å–®ç‹€æ…‹ç®¡ç† (pending, cancelled ç­‰ç‹€æ…‹è½‰æ›)

### ğŸ“Š ç³»çµ±å“è³ª
- âœ… çµ±ä¸€ API å›æ‡‰æ ¼å¼
- âœ… TypeScript å‹åˆ¥å®‰å…¨
- âœ… å®Œæ•´çš„éŒ¯èª¤è™•ç†
- âœ… æ¸…æ™°çš„ç¨‹å¼ç¢¼çµæ§‹
- âœ… RESTful API è¨­è¨ˆ

## ğŸ”§ JWT é‹ä½œåŸç†

### JWT èªè­‰æµç¨‹

```mermaid
sequenceDiagram
    participant Client
    participant Server
    participant Database

    Client->>Server: POST /api/v1/auth/login (email, password)
    Server->>Database: é©—è­‰ä½¿ç”¨è€…è³‡æ–™
    Database-->>Server: ä½¿ç”¨è€…è³‡æ–™ + å¯†ç¢¼æª¢æŸ¥
    Server-->>Client: Access Token + Refresh Token

    Client->>Server: GET /api/v1/auth/profile (Bearer Token)
    Server->>Server: é©—è­‰ JWT Token
    Server->>Database: æ ¹æ“š JWT payload å–å¾—ä½¿ç”¨è€…è³‡æ–™
    Database-->>Server: ä½¿ç”¨è€…å®Œæ•´è³‡æ–™
    Server-->>Client: ä½¿ç”¨è€…è³‡æ–™
```

### JWT Token çµæ§‹

```javascript
// Access Token Payload
{
  id: 2,
  email: "test@example.com", 
  role: "buyer",
  iat: 1754909708,  // ç™¼è¡Œæ™‚é–“
  exp: 1754910608,  // éæœŸæ™‚é–“ (15åˆ†é˜)
  aud: "neng-shop-users",  // å—çœ¾
  iss: "neng-shop"  // ç™¼è¡Œè€…
}

// JWT ä¸­ä»‹è»Ÿé«”è™•ç†æµç¨‹
1. æª¢æŸ¥ Authorization header æ˜¯å¦å­˜åœ¨
2. æå– Bearer token 
3. é©—è­‰ token æœ‰æ•ˆæ€§ (ç°½åã€éæœŸæ™‚é–“)
4. å°‡è§£ç¢¼å¾Œçš„ä½¿ç”¨è€…è³‡æ–™æ³¨å…¥åˆ° req.user
5. ç¹¼çºŒè™•ç†è«‹æ±‚
```

### å®‰å…¨ç‰¹æ€§

- **ç„¡ç‹€æ…‹**: ä¼ºæœå™¨ä¸éœ€è¦å„²å­˜ session
- **è‡ªåŒ…å«**: token åŒ…å«æ‰€æœ‰å¿…è¦çš„ä½¿ç”¨è€…è³‡è¨Š
- **éæœŸæ©Ÿåˆ¶**: Access Token 15åˆ†é˜è‡ªå‹•éæœŸ
- **è§’è‰²æª¢æŸ¥**: æ”¯æ´ buyer/seller/admin æ¬Šé™æ§åˆ¶

